<!DOCTYPE html>
<html>
    <head>
        <title>Singulr Test</title>
        
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
        
        <!-- Auto redirect to https -->
        <script>var a=window.location;"https:"!==a.protocol&&(a.href="https:"+a.href.substring(a.protocol.length));</script>
    </head>
    
    <body>
        <div id="wrapper">
            <div id="loader-wrapper">
                <div id="loader">
                    
                </div>
                
                <div class="loader-section section-left"></div>
                <div class="loader-section section-right"></div>
            </div>
            <div id="page"></div>
        </div>
        
        <div id="swipe-to"></div>
        
        
        <!-- Add to home screen -->
        <div id="add-to-home-screen" style="display: none" ontouchstart="this.classList.toggle('open')">
            <div id="top">
                Download the Singulr mobile app for free.
            </div>
            <p>
                Simply tap the <img src="img/add-to-home-screen.png"> button below, and choose "Add to Home Screen".
            </p>
            <p>
                The mobile app will then be installed as an icon on your home screen.
            </p>
            <div>
                 http://www.flaticon.com/free-icon/download-arrow_109611 
                <img id="arrow" src="img/down-arrow.svg"></img>
            </div>
        </div>
        <!-- If iPhone display add to home screen -->
        <!--<script>-1<navigator.userAgent.search(/iPhone/)&&(document.getElementById("add-to-home-screen").style.display="block")</script>-->
        
        
        <!-- Singulr -->
        <script src="singulr.js"></script>
        
        <script>
            /* global Singulr */
            /* global Slideback */
            
            
            // milliseconds
            var start = Date.now();
            
            Singulr.init({
                onPageLoaded: function() {
                    var elements = document.getElementsByTagName('a');
                    var page = Singulr.getPage();
                    
                    console.log('page: ' + page);
                    
                    for (var i = 0; i < elements.length; i++) { 
                        if (page === elements[i].getAttribute('href')) {
                            elements[i].classList.add('current');
                        } else {
                            elements[i].classList.remove('current');
                        }
                    }
                },
                dependencies: {
                    // Slideback
                    javascript: ['https://rawgit.com/richyliu/slideback/gh-pages/slideback.js', 'https://cdn.firebase.com/js/client/2.2.1/firebase.js'],
                    css: ['css/stylesheet.css']
                },
                onDependenciesLoaded: function() {
                    Slideback();
                    
                    var now = Date.now();
                    // less than 1 second
                    if (now - start < 1000) {
                        setTimeout(function() {
                            document.getElementsByTagName('body')[0].classList.add('loaded');
                        }, 1000 - (now - start));
                    } else {
                        document.getElementsByTagName('body')[0].classList.add('loaded');
                    }
                }
            });
        </script>
    </body>
</html>