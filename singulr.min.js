/*! Singulr v0.0.1r8 | (c) Richard Liu | MIT License */

(function(h,l){function A(){function a(){var b=this.getAttribute("href");-1<b.search(/^(?:[a-z]+:)?\/\//i)||b===r||(v(b),event.preventDefault())}function c(b){p(h.location.href.substr(h.location.href.lastIndexOf("/")+1))}for(var e=h.getElementsByTagName("a"),b=0;b<e.length;b++)e[b].removeEventListener("click",a);e=h.getElementsByTagName("a");for(b=0;b<e.length;b++)e[b].addEventListener("click",a);null===l.onpopstate&&(l.onpopstate=c)}function v(a){console.log("loading: "+a);l.history.pushState({},
"",a);p(a)}function p(a){function c(a){if(m!==[]){for(var b=0;b<m.length;b++)q(m[b]);y();m=[]}A();if(!a||"string"!==typeof a)throw"Invalid page";var c=h.implementation.createHTMLDocument();-1<a.search("<html>")?c.body.parentElement.innerHTML=a:c.body.parentElement.innerHTML="<html>"+a+"</html>";var f,b=c.getElementsByTagName("title")[0];null!==b&&""!==b&&(h.title=b.innerHTML);if(c.getElementsByTagName("style")!==[])for(var d=c.getElementsByTagName("style"),b=0;b<d.length;b++)f=d[b].innerHTML,""!==
f&&(a=h.createElement("style"),a.innerHTML=f,h.getElementsByTagName("head")[0].appendChild(a),m.push(a)),q(d[b]);if(c.getElementsByTagName("link")!==[])for(d=c.getElementsByTagName("link"),b=0;b<d.length;b++)"stylesheet"===d[b].getAttribute("rel")&&(f=d[b].getAttribute("href"),a=h.createElement("link"),a.rel="stylesheet",a.type="text/css",a.href=f,h.getElementsByTagName("head")[0].appendChild(a),m.push(a)),q(d[b]);d=[];if(c.getElementsByTagName("head")[0].getElementsByTagName("script")!==[])for(var k=
c.getElementsByTagName("head")[0].getElementsByTagName("script"),b=0;b<k.length;b++)"singulr-ignore"!==k[b].getAttribute("id")&&(f=k[b].getAttribute("src"),a=k[b].innerHTML,null!==f?d.push(["src",f]):""!==a&&d.push(["code",a]),q(k[b]));w(d);if(c.getElementsByTagName("body")[0].getElementsByTagName("script")!==[])for(k=c.getElementsByTagName("body")[0].getElementsByTagName("script"),b=0;b<k.length;b++)"singulr-ignore"!==k[b].getAttribute("id")&&(f=k[b].getAttribute("src"),a=k[b].innerHTML,null!==f?
t.push(["src",f]):""!==a&&t.push(["code",a]),q(k[b]));a=g.analyticNodes;if(0<a.length)for(b=0;b<a.length;b++)h.getElementsByTagName("body")[0].appendChild(a[b]),m.push(a[b]);y();return c.documentElement.getElementsByTagName("body")[0].innerHTML}r=a;try{z(g.CONTENT_ID,r,c)}catch(e){console.error(e),p(g.PAGE_404)}}function z(a,c,e){var b=new XMLHttpRequest;b.open("GET",c,!0);b.onreadystatechange=function(){if(4===b.readyState&&200===b.status){var c=e(b.responseText);if("string"===typeof c)h.getElementById(a).innerHTML=
c;else if(void 0===c)h.getElementById(a).innerHTML=b.responseText;else throw Error("Invalid callback return!");g.onDocumentLoaded()}else 404===b.status&&p(g.PAGE_404);w(t);t=[];g.onPageLoaded()};b.send()}function B(a,c){var e=h.createElement("script");e.async=1;e.onload=e.onreadystatechange=function(){c();e.parentNode.removeChild(e)};e.src=a;h.getElementsByTagName("body")[0].appendChild(e)}function w(a,c){0!==a.length&&(c=c||function(){},console.log(a),n=[],n=a,x(0,c))}function x(a,c){"src"===n[a][0]?
B(n[a][1],function(){void 0!==n[a+1]?x(a+1,c):c()}):"code"===n[a][0]&&(l.eval.call(l,n[a][1]),void 0!==n[a+1]?x(a+1,c):c())}function q(a){if(void 0===a||null===a)console.warn("No node provided!");else{if(null===a.parentNode)throw Error("Node has been already removed");u.push(a)}}function y(){for(var a=0;a<u.length;a++){var c=u[a];c.parentNode.removeChild(c)}u=[]}function C(a,c){function e(){!b&&c&&(b=!0,c.call(a))}var b;a.addEventListener&&a.addEventListener("load",e);a.attachEvent&&a.attachEvent("onload",
e);if("isApplicationInstalled"in navigator&&"onloadcssdefined"in a)a.onloadcssdefined(e)}var r="",m=[],u=[],t=[],n=[],g={onDocumentLoaded:function(){},onPageLoaded:function(){},onDependenciesLoaded:function(){},analyticNodes:[],HOME_PAGE:"home.html",BASE_PAGE:"base.html",PAGE_404:"404.html",PAGE_ID:"page",CONTENT_ID:"content",dependencies:{javascript:[],css:[]}};l.Singulr={init:function(a){if(void 0!==a)for(var c in a)a.hasOwnProperty(c)&&void 0!==g[c]&&(g[c]=a[c]);a=[];for(c=0;c<g.dependencies.javascript.length;c++)a.push(["src",
g.dependencies.javascript[c]]);w(a,function(){var a=g.dependencies.css,b=[];console.log(b);for(var c,f=0;f<a.length;f++)c=D(a[f]),C(c,function(){b[a]=!0;for(var a=0;a<b.length;a++)if(!1===b[a])return;g.onDependenciesLoaded();z(g.PAGE_ID,g.BASE_PAGE,function(){var a=l.location.href.substr(l.location.href.lastIndexOf("/")+1),a=a.substr(a.indexOf("?")+1),a=decodeURIComponent(a);l.history.replaceState({},"",a);var b;if(b=0<a.length)b=l.location.href.lastIndexOf("/")===l.location.href.length-1?"/"+g.HOME_PAGE:
l.location.href.match(/[^\/](\/[\w\%\-\_]+(\.[a-zA-Z]+)?)+(?:(?=\#|\?)|$)/)[0].substr(1),b=b!==r;b?v(a):p(g.HOME_PAGE)})})})},getPage:function(){return l.location.href.lastIndexOf("/")===l.location.href.length-1?"/"+g.HOME_PAGE:l.location.href.match(/[^\/](\/[\w\%\-\_]+(\.[a-zA-Z]+)?)+.*$/)[0].substr(1)},loadPage:v};var D=function(a,c,e){function b(a){if(f.body)return a();setTimeout(function(){b(a)})}function g(){d.addEventListener&&d.removeEventListener("load",g);d.media=e||"all"}var f=l.document,
d=f.createElement("link"),k;if(c)k=c;else{var h=(f.body||f.getElementsByTagName("head")[0]).childNodes;k=h[h.length-1]}var n=f.styleSheets;d.rel="stylesheet";d.href=a;d.media="only x";b(function(){k.parentNode.insertBefore(d,c?k:k.nextSibling)});var m=function(a){for(var b=d.href,c=n.length;c--;)if(n[c].href===b)return a();setTimeout(function(){m(a)})};d.addEventListener&&d.addEventListener("load",g);d.onloadcssdefined=m;m(g);return d}})(document,window);
