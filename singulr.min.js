/*! Singulr v0.0.1r11 | (c) Richard Liu | MIT License */

(function(d,k){function w(){function a(b){console.log("click!");var a=this.getAttribute("href"),e=b.target;1<b.which||b.metaKey||b.ctrlKey||b.shiftKey||b.altKey||k.location.protocol!==e.protocol||k.location.hostname!==e.hostname||-1<e.href.indexOf("#")&&e.href.replace(/#.*/,"")==k.location.href.replace(/#.*/,"")||b.isDefaultPrevented()||(t(a),b.preventDefault())}function c(b){p(d.location.href.substr(d.location.href.lastIndexOf("/")+1))}for(var b=d.getElementsByTagName("a"),e=0;e<b.length;e++)b[e].removeEventListener("click",
a);b=d.getElementsByTagName("a");for(e=0;e<b.length;e++)b[e].addEventListener("click",a);null===k.onpopstate&&(k.onpopstate=c)}function A(){function a(b){"N"==b.animationName&&(console.log("node inserted!"),console.log(b),w())}d.removeEventListener("animationstart",a,!1);d.removeEventListener("MSAnimationStart",a,!1);d.removeEventListener("webkitAnimationStart",a,!1);d.addEventListener("animationstart",a,!1);d.addEventListener("MSAnimationStart",a,!1);d.addEventListener("webkitAnimationStart",a,!1);
var c=d.createElement("style");c.innerHTML="@-webkit-keyframes fLhpiHgvMd{}@-moz-keyframes fLhpiHgvMd{}@-o-keyframes fLhpiHgvMd{}@keyframes fLhpiHgvMd{}a{-webkit-animation-name:fLhpiHgvMd;-moz-animation-name:fLhpiHgvMd;-o-animation-name:fLhpiHgvMd;animation-name:fLhpiHgvMd}";d.getElementsByTagName("head")[0].appendChild(c)}function t(a){console.log("load page external: "+a);k.history.pushState({},"",a);p(a)}function p(a){function c(b){if(m!==[]){for(var a=0;a<m.length;a++)n(m[a]);x();m=[]}if(!b||
"string"!==typeof b)throw"Invalid page";var c=d.implementation.createHTMLDocument();-1<b.search("<html>")?c.body.parentElement.innerHTML=b:c.body.parentElement.innerHTML="<html>"+b+"</html>";var h,a=c.getElementsByTagName("title")[0];null!==a&&""!==a&&(d.title=a.innerHTML);if(c.getElementsByTagName("style")!==[])for(var f=c.getElementsByTagName("style"),a=0;a<f.length;a++)h=f[a].innerHTML,""!==h&&(b=d.createElement("style"),b.innerHTML=h,d.getElementsByTagName("head")[0].appendChild(b),m.push(b)),
n(f[a]);if(c.getElementsByTagName("link")!==[])for(f=c.getElementsByTagName("link"),a=0;a<f.length;a++)"stylesheet"===f[a].getAttribute("rel")&&(h=f[a].getAttribute("href"),b=d.createElement("link"),b.rel="stylesheet",b.type="text/css",b.href=h,d.getElementsByTagName("head")[0].appendChild(b),m.push(b)),n(f[a]);f=[];if(c.getElementsByTagName("head")[0].getElementsByTagName("script")!==[])for(var l=c.getElementsByTagName("head")[0].getElementsByTagName("script"),a=0;a<l.length;a++)"singulr-ignore"!==
l[a].getAttribute("class")&&(h=l[a].getAttribute("src"),b=l[a].innerHTML,null!==h?f.push(["src",h]):""!==b&&f.push(["code",b]),n(l[a]));u(f);if(c.getElementsByTagName("body")[0].getElementsByTagName("script")!==[])for(l=c.getElementsByTagName("body")[0].getElementsByTagName("script"),a=0;a<l.length;a++)"singulr-ignore"!==l[a].getAttribute("class")&&(h=l[a].getAttribute("src"),b=l[a].innerHTML,null!==h?q.push(["src",h]):""!==b&&q.push(["code",b]),n(l[a]));b=g.analyticNodes;if(0<b.length)for(a=0;a<
b.length;a++)d.getElementsByTagName("body")[0].appendChild(b[a]),m.push(b[a]);x();return c.documentElement.getElementsByTagName("body")[0].innerHTML}y=a;try{z(g.CONTENT_ID,y,c)}catch(b){console.error(b),p(g.PAGE_404)}}function z(a,c,b){var e=new XMLHttpRequest;e.open("GET",c,!0);e.onreadystatechange=function(){if(4===e.readyState&&200===e.status){var c=b(e.responseText);if("string"===typeof c)d.getElementById(a).innerHTML=c;else if(void 0===c)d.getElementById(a).innerHTML=e.responseText;else throw Error("Invalid callback return!");
}else 404===e.status&&p(g.PAGE_404);if(a===g.CONTENT_ID)g.onDocumentLoaded();u(q,function(){q=[];if(a===g.CONTENT_ID)g.onPageLoaded();w()})};e.send()}function B(a,c){var b=d.createElement("script");b.async=!1;b.onload=b.onreadystatechange=function(){c();b.parentNode.removeChild(b)};b.src=a;d.getElementsByTagName("body")[0].appendChild(b)}function u(a,c){0<a.length?v(0,a,c||function(){}):"function"===typeof c&&c()}function v(a,c,b){"src"===c[a][0]?B(c[a][1],function(){void 0!==c[a+1]?v(a+1,c,b):b()}):
"code"===c[a][0]&&(k.eval.call(k,c[a][1]),void 0!==c[a+1]?v(a+1,c,b):b())}function n(a){if(void 0===a||null===a)console.warn("No node provided!");else{if(null===a.parentNode)throw Error("Node has been already removed");r.push(a)}}function x(){for(var a=0;a<r.length;a++){var c=r[a];c.parentNode.removeChild(c)}r=[]}function C(a,c){function b(){!e&&c&&(e=!0,c.call(a))}var e;a.addEventListener&&a.addEventListener("load",b);a.attachEvent&&a.attachEvent("onload",b);if("isApplicationInstalled"in navigator&&
"onloadcssdefined"in a)a.onloadcssdefined(b)}console.log("fo");var y="",m=[],r=[],q=[],g={onDocumentLoaded:function(){},onPageLoaded:function(){},onDependenciesLoaded:function(){},analyticNodes:[],HOME_PAGE:"home.html",BASE_PAGE:"base.html",PAGE_404:"404.html",PAGE_ID:"page",CONTENT_ID:"content",dependencies:{javascript:[],css:[]}};k.Singulr={init:function(a){function c(){g.onDependenciesLoaded();z(g.PAGE_ID,g.BASE_PAGE,function(){var a=k.location.href.substr(k.location.href.lastIndexOf("/")+1),a=
a.substr(a.indexOf("?")+1),a=decodeURIComponent(a);k.history.replaceState({},"",a);console.log("curFullPageUrl: "+a);console.warn(Error().stack);0<a.length&&"index.html"!==a?t(a):p(g.HOME_PAGE)})}if(void 0!==a)for(var b in a)a.hasOwnProperty(b)&&void 0!==g[b]&&(g[b]=a[b]);A();var e=!1,d=!0;b=[];for(a=0;a<g.dependencies.javascript.length;a++)b.push(["src",g.dependencies.javascript[a]]);u(b,function(){e=!0;d&&c()});b=g.dependencies.css;var h=[],f;for(a=0;a<b.length;a++)f=D(b[a]),C(f,function(){h[a]=
!0;for(var a=0;a<h.length;a++)if(!1===h[a])return;d=!0;e&&c()})},getPage:function(){return"index.html"===k.location.pathname.substr(k.location.pathname.lastIndexOf("/")+1)||"/"===k.location.pathname.charAt(k.location.pathname.length-1)?"/"+g.HOME_PAGE:k.location.href.match(/[^\/](\/[\w\%\-\_]+(\.[a-zA-Z]+)?)+.*$/)[0].substr(1)},loadPage:t};var D=function(a,c,b){function e(a){if(h.body)return a();setTimeout(function(){e(a)})}function d(){f.addEventListener&&f.removeEventListener("load",d);f.media=
b||"all"}var h=k.document,f=h.createElement("link"),g;if(c)g=c;else{var m=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=m[m.length-1]}var p=h.styleSheets;f.rel="stylesheet";f.href=a;f.media="only x";e(function(){g.parentNode.insertBefore(f,c?g:g.nextSibling)});var n=function(a){for(var b=f.href,c=p.length;c--;)if(p[c].href===b)return a();setTimeout(function(){n(a)})};f.addEventListener&&f.addEventListener("load",d);f.onloadcssdefined=n;n(d);return f}})(document,window);
